import numpy as np

from scipy.signal import savgol_filter

import matplotlib.pyplot as plt


x=[152. , 152.1, 152.2, 152.3, 152.4, 152.5, 152.6, 152.7, 152.8,
       152.9, 153. , 153.1, 153.2, 153.3, 153.4, 153.5, 153.6, 153.7,
       153.8, 153.9, 154. , 154.1, 154.2, 154.3, 154.4, 154.5, 154.6,
       154.7, 154.8, 154.9, 155. , 155.1, 155.2, 155.3, 155.4, 155.5,
       155.6, 155.7, 155.8, 155.9, 156. , 156.1, 156.2, 156.3, 156.4,
       156.5, 156.6, 156.7, 156.8, 156.9, 157. , 157.1, 157.2, 157.3,
       157.4, 157.5, 157.6, 157.7, 157.8, 157.9, 158. , 158.1, 158.2,
       158.3, 158.4, 158.5, 158.6, 158.7, 158.8, 158.9, 159. , 159.1,
       159.2, 159.3, 159.4, 159.5, 159.6, 159.7, 159.8, 159.9, 160. ,
       160.1, 160.2, 160.3, 160.4, 160.5, 160.6, 160.7, 160.8, 160.9,
       161. , 161.1, 161.2, 161.3, 161.4, 161.5, 161.6, 161.7, 161.8,
       161.9, 162. ]
y=[ 2.69090763e-04,  7.81231248e-05, -2.60410416e-05, -2.23699174e-03,
        6.78572394e-03,  1.81117542e-02,  3.07347036e-02,  3.40035761e-02,
        4.07670463e-02,  4.63850806e-02,  4.59208239e-02,  3.95918023e-02,
        3.78323727e-02,  5.63203606e-02,  6.79907176e-02,  7.17919901e-02,
        7.35211715e-02,  8.44112247e-02,  9.34830466e-02,  1.12295863e-01,
        1.26752234e-01,  1.30827747e-01,  1.42789474e-01,  1.71493433e-01,
        2.00348639e-01,  2.32819895e-01,  2.69975918e-01,  3.04078874e-01,
        3.45514422e-01,  3.86751986e-01,  4.31967187e-01,  4.79127406e-01,
        5.37099907e-01,  5.94485746e-01,  6.61594823e-01,  7.34066389e-01,
        7.95800905e-01,  8.57933500e-01,  8.98261151e-01,  9.25931968e-01,
        9.41780954e-01,  9.69263363e-01,  9.77311645e-01,  1.00000000e+00,
        9.88568606e-01,  9.47200764e-01,  8.96820787e-01,  8.84452991e-01,
        8.36472086e-01,  7.99663860e-01,  7.64263367e-01,  7.32867846e-01,
        6.47701508e-01,  5.92641785e-01,  5.33188659e-01,  4.93960772e-01,
        4.44396106e-01,  3.97217638e-01,  3.57122753e-01,  3.22818029e-01,
        2.84984469e-01,  2.52711787e-01,  2.34918151e-01,  2.19296291e-01,
        1.94644001e-01,  1.68815356e-01,  1.52391067e-01,  1.39388258e-01,
        1.16721877e-01,  9.96031308e-02,  9.73553186e-02,  8.92483339e-02,
        7.62426022e-02,  6.80252066e-02,  6.08883217e-02,  4.18491875e-02,
        4.05555842e-02,  3.85414700e-02,  4.38747951e-02,  3.77471227e-02,
        3.74150894e-02,  3.38452607e-02,  3.13772497e-02,  2.50366346e-02,
        1.72491477e-02,  1.33352238e-02,  2.34247987e-02,  2.65567467e-02,
        1.95321613e-02,  6.13139822e-03,  9.32846271e-03,  7.18223910e-03,
        4.40894445e-03, -2.40383675e-03,  3.08631348e-03,  1.40123545e-02,
        1.49510237e-02,  5.90232115e-03, -1.77970654e-03, -2.96617756e-03,
        1.77970654e-03]

y = savgol_filter(y, 5, 2)

y = y.tolist()

maxindice = y.index(max(y))
print(maxindice)
print(y[maxindice])

nx = [x[maxindice-1],x[maxindice],x[maxindice+1]]
ny = [y[maxindice-1],y[maxindice],y[maxindice+1]]

for i in [1,2,3,4,5]:
    print('{}{}{}<->{}====='.format(i,x[maxindice-i],x[maxindice+i],(x[maxindice-i]+x[maxindice+i])/2))
#print((x[maxindice-2]+x[maxindice+2])/2)
#fit = np.polyfit(nx,ny,2)
#p = np.poly1d(fit)

#plt.plot(nx,ny)
#plt.plot(nx,p)
#plt.show()
